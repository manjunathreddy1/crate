import { spfi } from "@pnp/sp";
import { SPFx } from "@pnp/sp";
import "@pnp/sp/webs";
import "@pnp/sp/files";
import "@pnp/sp/items";
import "@pnp/sp/site-users";

// Initialize spfi
const sp = spfi().using(SPFx(context)); // use your actual context

const destinationFileUrl = "/sites/yoursite/SitePages/MyPage.aspx";

// Step 1: Get the file's list item
const pageItem = await sp.web.getFileByServerRelativePath(destinationFileUrl).getItem();

// Step 2: Ensure the user exists and get their ID
const currentUser = await sp.web.currentUser();
const ensuredUser = await sp.web.ensureUser(currentUser.LoginName);

// Step 3: Update the Author field
await pageItem.update({
  AuthorId: ensuredUser.Id,
});
